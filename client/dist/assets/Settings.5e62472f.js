import{D as G,b as O}from"./DashWrapper.e3c9073d.js";import{s as $,e as y,v as J,r as n,m as Q,_ as Y,b as t,n as K,o as Z,A as V,u as B,c as I,j as g,F as W}from"./index.478a61fd.js";import{u as U,T as F,A as T,F as ee,S as te,D as re,a as oe,b as ie,c as ae,d as se}from"./StyledDialog.1a698e56.js";import{u as M,G as x,b as _,a as ne,B as j,m as le,T as R}from"./jsx-runtime_commonjs-proxy.1e317760.js";import{L as k,d as X}from"./Save.3f989c87.js";import{g as ce,S as P,a as de}from"./Delete.0b72d671.js";import{c as me,a as q,b as pe,o as ue,P as z}from"./object.df25c3fd.js";import"./upperFirst.35ba8dd0.js";const he=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],fe=r=>{const{absolute:e,children:o,classes:l,flexItem:m,light:a,orientation:s,textAlign:i,variant:f}=r;return Z({root:["root",e&&"absolute",f,a&&"light",s==="vertical"&&"vertical",m&&"flexItem",o&&"withChildren",o&&s==="vertical"&&"withChildrenVertical",i==="right"&&s!=="vertical"&&"textAlignRight",i==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},ce,l)},xe=$("div",{name:"MuiDivider",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.root,o.absolute&&e.absolute,e[o.variant],o.light&&e.light,o.orientation==="vertical"&&e.vertical,o.flexItem&&e.flexItem,o.children&&e.withChildren,o.children&&o.orientation==="vertical"&&e.withChildrenVertical,o.textAlign==="right"&&o.orientation!=="vertical"&&e.textAlignRight,o.textAlign==="left"&&o.orientation!=="vertical"&&e.textAlignLeft]}})(({theme:r,ownerState:e})=>y({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(r.vars||r).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:r.vars?`rgba(${r.vars.palette.dividerChannel} / 0.08)`:J(r.palette.divider,.08)},e.variant==="inset"&&{marginLeft:72},e.variant==="middle"&&e.orientation==="horizontal"&&{marginLeft:r.spacing(2),marginRight:r.spacing(2)},e.variant==="middle"&&e.orientation==="vertical"&&{marginTop:r.spacing(1),marginBottom:r.spacing(1)},e.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({theme:r,ownerState:e})=>y({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(r.vars||r).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}}),({theme:r,ownerState:e})=>y({},e.children&&e.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(r.vars||r).palette.divider}`,transform:"translateX(0%)"}}),({ownerState:r})=>y({},r.textAlign==="right"&&r.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},r.textAlign==="left"&&r.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),ge=$("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.wrapper,o.orientation==="vertical"&&e.wrapperVertical]}})(({theme:r,ownerState:e})=>y({display:"inline-block",paddingLeft:`calc(${r.spacing(1)} * 1.2)`,paddingRight:`calc(${r.spacing(1)} * 1.2)`},e.orientation==="vertical"&&{paddingTop:`calc(${r.spacing(1)} * 1.2)`,paddingBottom:`calc(${r.spacing(1)} * 1.2)`})),ve=n.exports.forwardRef(function(e,o){const l=Q({props:e,name:"MuiDivider"}),{absolute:m=!1,children:a,className:s,component:i=a?"div":"hr",flexItem:f=!1,light:p=!1,orientation:E="horizontal",role:c=i!=="hr"?"separator":void 0,textAlign:b="center",variant:u="fullWidth"}=l,d=Y(l,he),h=y({},l,{absolute:m,component:i,flexItem:f,light:p,orientation:E,role:c,textAlign:b,variant:u}),w=fe(h);return t(xe,y({as:i,className:K(w.root,s),role:c,ref:o,ownerState:h},d,{children:a?t(ge,{className:w.wrapper,ownerState:h,children:a}):null}))});var H=ve;const be="Account",N={helper:`${be}-helper`},we=$("form")(({theme:r})=>({width:"100%",display:"flex",flexDirection:"column",gap:"2rem",marginTop:"2rem",marginBottom:"2rem",[`&. ${N.helper}`]:{color:r.palette.text.primary}})),Ee=r=>{var D,C,v;const{user:e,updateUser:o}=n.exports.useContext(V),l=B(),m=I(),a=M("(max-width: 900px)"),[s,i]=n.exports.useState(!1),[f,p]=n.exports.useState(!1),[E,c]=n.exports.useState(!1);e||l("/",{state:{from:m}});const{register:b,handleSubmit:u,formState:{errors:d}}=U({mode:"onBlur",defaultValues:{firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName,email:e==null?void 0:e.email}}),h=async A=>{if(i(!0),!e){l("/",{state:{from:m}});return}try{await o(A,e==null?void 0:e._id),c(!0)}catch(L){console.error({error:L}),p(!0)}finally{i(!1)}},w=(A,L)=>{L!=="clickaway"&&p(!1)},S=(A,L)=>{L!=="clickaway"&&c(!1)};return g(W,{children:[g(we,{onSubmit:u(h),children:[g(x,{container:!0,children:[t(x,{item:!0,xs:12,md:6,sx:{paddingRight:a?"":".5rem",marginBottom:a?"2rem":""},children:t(F,{...b("firstName",{required:{value:!0,message:"Le pr\xE9nom est obligatoire"},validate:_||"Le pr\xE9nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:d.firstName&&((D=d.firstName)==null?void 0:D.message),FormHelperTextProps:{className:N.helper},fullWidth:!0,label:"Pr\xE9nom",type:"text",color:"info",variant:"filled",required:!0,defaultValue:e==null?void 0:e.firstName})}),t(x,{item:!0,xs:12,md:6,paddingLeft:a?"":".5rem",children:t(F,{...b("lastName",{required:{value:!0,message:"Le nom est obligatoire"},validate:A=>_(A)||"Le nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:d.lastName&&((C=d.lastName)==null?void 0:C.message),FormHelperTextProps:{className:N.helper},label:"Nom",type:"text",color:"info",variant:"filled",required:!0,fullWidth:!0,defaultValue:e==null?void 0:e.lastName})})]}),t(x,{item:!0,xs:12,children:t(F,{...b("email",{required:{value:!0,message:"L'email est obligatoire"},validate:ne||"Vous devez saisir un email valide"}),defaultValue:e==null?void 0:e.email,helperText:d.email&&((v=d.email)==null?void 0:v.message),FormHelperTextProps:{className:N.helper},color:"info",type:"email",label:"Email",variant:"filled",required:!0,fullWidth:!0})}),t(x,{item:!0,xs:12,display:"flex",justifyContent:"end",children:t(k,{loading:s,type:"submit",loadingPosition:"start",startIcon:t(X,{}),variant:"contained",color:"info",children:"Enregistrer les modifications"})})]}),t(P,{open:E,autoHideDuration:6e3,onClose:S,children:t(T,{onClose:S,severity:"success",sx:{width:"100%"},children:"Vos informations ont bient \xE9t\xE9 mises \xE0 jour."})}),t(P,{open:f,autoHideDuration:6e3,onClose:w,children:t(T,{onClose:w,severity:"error",sx:{width:"100%"},children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."})})]})},ye="Password",Ce={helper:`${ye}-helper`},Se=$("form")(({theme:r})=>({width:"100%",display:"flex",flexDirection:"column",gap:"2rem",marginTop:"2rem",marginBottom:"2rem",[`&. ${Ce.helper}`]:{color:r.palette.text.primary}})),De=r=>{var S,D;const{user:e,updatePassword:o}=n.exports.useContext(V),l=B(),m=I(),a=M("(max-width: 900px)"),[s,i]=n.exports.useState(!1),[f,p]=n.exports.useState(!1),[E,c]=n.exports.useState(!1),b=me().shape({password:q().required("Le mot de passe est obligatoire").min(6,"Le mot de passe doit contenir au moins 6 caract\xE8res"),confirmPassword:q().required("Le mot de passe est obligatoire").oneOf([pe("password")],"Les mots de passe ne sont pas identiques")}),u=U({mode:"onBlur",resolver:ue(b)}),d=async C=>{if(i(!0),!e){l("/",{state:{from:m}});return}try{await o({password:C.password},e._id)?p(!0):c(!0)}catch(v){console.error({error:v}),c(!0)}finally{i(!1)}},h=(C,v)=>{v!=="clickaway"&&c(!1)},w=(C,v)=>{v!=="clickaway"&&p(!1)};return g(W,{children:[t(ee,{...u,children:g(Se,{onSubmit:u.handleSubmit(d),children:[g(x,{container:!0,children:[t(x,{item:!0,xs:12,md:6,sx:{paddingRight:a?"":".5rem",marginBottom:a?"2rem":""},children:t(z,{name:"password",color:"info",defaultValue:"",error:u.formState.errors.password!==void 0,errorMessage:(S=u.formState.errors.password)==null?void 0:S.message,fullWidth:!0,id:"new-password",label:"Nouveau mot de passe"})}),t(x,{item:!0,xs:12,md:6,paddingLeft:a?"":".5rem",children:t(z,{name:"confirmPassword",color:"info",defaultValue:"",error:u.formState.errors.confirmPassword!==void 0,errorMessage:(D=u.formState.errors.confirmPassword)==null?void 0:D.message,fullWidth:!0,id:"confirm-new-password",label:"Confirmez le nouveau mot de passe"})})]}),t(x,{item:!0,xs:12,display:"flex",justifyContent:"end",children:t(k,{loading:s,type:"submit",loadingPosition:"start",startIcon:t(X,{}),variant:"contained",color:"info",children:"Enregistrer le nouveau mot de passe"})})]})}),t(P,{open:f,autoHideDuration:6e3,onClose:w,children:t(T,{onClose:w,severity:"success",sx:{width:"100%"},children:"Votre mot de passe a bien \xE9t\xE9 mis \xE0 jour."})}),t(P,{open:E,autoHideDuration:6e3,onClose:h,children:t(T,{onClose:h,severity:"error",sx:{width:"100%"},children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."})})]})},Ae=r=>{const{user:e,deleteUser:o,logout:l}=n.exports.useContext(V),m=B(),a=I(),[s,i]=n.exports.useState(!1),[f,p]=n.exports.useState(!1),[E,c]=n.exports.useState(!1);return g(W,{children:[t("div",{style:{display:"flex",justifyContent:"end",marginBottom:"1rem",marginTop:"1rem"},children:t(j,{onClick:()=>i(!0),variant:"contained",color:"info",startIcon:t(de,{}),children:"Je supprime mon compte"})}),g(te,{open:s,setOpen:i,labelledby:"delete account",children:[t(re,{id:"delete-account",children:"\xCAtes vous s\xFBr de vouloir supprimer votre compte"}),t(oe,{children:t(ie,{children:"Votre compte sera d\xE9finitivement supprim\xE9 et ne pourra pas \xEAtre r\xE9cupr\xE9. Toutes vos todos seront \xE9galement supprim\xE9s."})}),g(ae,{children:[E&&t(se,{severity:"error",onClose:()=>c(!1),children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."}),t(j,{autoFocus:!0,disabled:f,color:"info",onClick:d=>{i(!1)},children:"Annuler"}),t(k,{loading:f,onClick:async d=>{if(p(!0),!e){m("/",{state:{from:a}});return}try{if((await o(e._id)).nDeleted>0){l(),m("/");return}else throw new Error("Le compte n'a pas pu \xEAtre supprim\xE9")}catch(h){console.error({error:h}),c(!0)}finally{p(!1)}},color:"info",autoFocus:!0,children:"Supprimer"})]})]})]})},Be=r=>{const e=le(),o=M("(max-width: 900px)");return t(G,{Icon:O,title:"PARAM\xC8TRES",children:g(x,{item:!0,xs:12,display:"flex",flexDirection:"column",children:[t(R,{component:"h1",variant:o?"h4":"h3",sx:{color:e.palette.text.primary},children:"Mes informations"}),t(Ee,{}),t(H,{}),t(R,{component:"h1",variant:o?"h4":"h3",sx:{color:e.palette.text.primary},mt:"2rem",children:"Changer mon mot de passe"}),t(De,{}),t(H,{}),t(R,{component:"h1",variant:o?"h4":"h3",sx:{color:e.palette.text.primary},mt:"2rem",children:"Supprimer mon compte"}),t(Ae,{})]})})};export{Be as default};
