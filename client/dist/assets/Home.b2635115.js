import{a as W,s as b,r as i,j as a,b as e,C as oe,F as $,u as R,c as X,R as se,A as M,T as ae}from"./index.478a61fd.js";import{u as F,S as ne,D as ie,a as le,b as ce,T as w,c as de,A as k,F as J,d as L,M as me}from"./StyledDialog.1a698e56.js";import{c as pe,i as ue,r as fe,B as u,a as j,T as G,b as B,G as N,u as xe,A as he}from"./jsx-runtime_commonjs-proxy.1e317760.js";import{P as A,c as ge,a as O,b as ve,o as be}from"./object.df25c3fd.js";import{B as Q}from"./Box.ca88577e.js";var q={},ye=ue.exports;Object.defineProperty(q,"__esModule",{value:!0});var K=q.default=void 0,Se=ye(pe),Ee=fe,we=(0,Se.default)((0,Ee.jsx)("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"}),"ArrowRightAlt");K=q.default=we;const $e="/api/tokens",Y=W.create({baseURL:$e}),Ce=r=>Y.post("/",r),Te=(r,s,o)=>Y.post(`/${r}/${s}`,o),Ne={createToken:Ce,resetPassword:Te},Pe="ResetPassword",Z={helper:`${Pe}-helper`},Re=b("form")(({theme:r})=>({display:"flex",flexDirection:"column",gap:"1rem",[`& .${Z.helper}`]:{color:r.palette.text.primary}})),Le=({open:r,setOpen:s})=>{const[o,n]=i.exports.useState(!1),[y,t]=i.exports.useState(!1),[l,d]=i.exports.useState(!1),{register:f,handleSubmit:x,formState:{errors:h}}=F({mode:"onBlur",defaultValues:{email:""}});return a(ne,{open:r,setOpen:s,labelledby:"reset-password",children:[e(ie,{id:"reset-password-title",children:"R\xE9initialisez votre mot de passe"}),e(le,{children:o?e(oe,{}):a($,{children:[e(ce,{children:"Vous \xEAtes sur le point de r\xE9initialiser votre mot de passe. Vous receverez un email avec un lien permettant de r\xE9initialiser votre mot de passe."}),e(Re,{onSubmit:x(m=>{if(n(!0),!j(m.email)){n(!1);return}Ne.createToken(m).then(()=>{d(!0)}).catch(p=>{if(W.isAxiosError(p)){console.error(p.response),t(!0);return}console.error({error:p}),t(!0)}).finally(()=>{n(!1)})}),id:"new-todo",children:e(w,{...f("email",{required:!0}),helperText:h.email&&"L'email est obligatoire",label:"Entrez votre email",type:"email",color:"info",variant:"filled",required:!0,FormHelperTextProps:{className:Z.helper}})})]})}),!o&&a(de,{children:[y&&e(k,{severity:"error",onClose:()=>t(!1),sx:{mx:4},children:"Un probl\xE8me est survenu, veuillez r\xE9essayer"}),l&&e(k,{severity:"success",onClose:()=>d(!1),sx:{mx:4},children:"Un email vous a \xE9t\xE9 envoy\xE9 pour r\xE9initialiser votre mot de passe."}),e(u,{autoFocus:!0,color:"info",onClick:()=>s(!1),children:"Annuler"}),e(u,{type:"submit",form:"new-todo",color:"info",autoFocus:!0,children:"Valider"})]})]})},Ae=r=>{const[s,o]=i.exports.useState(!1);return a($,{children:[e(u,{color:"info",variant:"text",onClick:()=>o(!0),endIcon:e(K,{color:"info"}),children:"Mot de passe oubli\xE9 ?"}),s&&e(Le,{open:s,setOpen:o})]})},U="Login",P={btnContainer:`${U}-btnContainer`,helper:`${U}-helper`},Ie=b("form")(({theme:r})=>({display:"flex",flexDirection:"column",gap:"2rem",width:"70%",[`& .${P.btnContainer}`]:{display:"flex",flexDirection:"column",gap:".5rem",alignItems:"center",justifyContent:"center"},[`& .${P.helper}`]:{color:r.palette.text.primary}})),Me=r=>{var m;const s=R(),o=X(),{from:n}=(o==null?void 0:o.state)||{pathname:"/dashboard"},{login:y}=se.useContext(M),{getTodos:t}=i.exports.useContext(ae),l=F({mode:"onBlur"}),[d,f]=i.exports.useState(!1),[x,h]=i.exports.useState(),S=async p=>{try{const E=await y(p);await t(E._id),s(n?n.pathname:"/dashboard")}catch(E){h(E),f(!0)}};return e(J,{...l,children:a(Ie,{onSubmit:l.handleSubmit(S),children:[n&&(n==null?void 0:n.pathname)?e(L,{severity:"warning",children:"Veuillez vous connecter pour acc\xE8der \xE0 cette page"}):null,e(w,{...l.register("email",{required:!0,validate:j}),defaultValue:"",helperText:l.formState.errors.email&&"Vous devez saisir un email valide",FormHelperTextProps:{className:P.helper},color:"info",type:"email",label:"Email",variant:"filled",required:!0}),e(A,{name:"password",options:{required:{value:!0,message:"Le mot de passe est obligatoire"},minLength:{value:6,message:"Le mot de passe doit contenir au moins 6 caract\xE8res"}},color:"info",defaultValue:"",error:l.formState.errors.password!==void 0,errorMessage:(m=l.formState.errors.password)==null?void 0:m.message,fullWidth:!0,id:"login-password",label:"Mot de passe"}),d&&e(L,{onClose:()=>{f(!1),h("")},severity:"error",children:a($,{children:["Une erreur est survenue, veuillez r\xE9essayer.",e("br",{}),"Message: ",x]})}),a("div",{className:P.btnContainer,children:[e(Ae,{}),e(u,{variant:"contained",color:"info",type:"submit",children:"Se connecter"})]})]})})},Fe={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"2rem",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50%",maxWidth:"90%",height:"auto",maxHeight:"90%",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},C="Signup",c={container:`${C}-container`,title:`${C}-title`,btnContainer:`${C}-btnContainer`,helper:`${C}-helper`},je=b(me)(({theme:r})=>({[`& .${c.title}`]:{marginTop:"20px",marginBottom:"20px",color:r.palette.text.primary,display:"flex",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},[`& .${c.title}:before`]:{content:'""',borderTop:`1px solid ${r.palette.secondary.main}`,margin:"0 20px 0 0",flex:"1 0 20px"},[`& .${c.title}:after`]:{content:'""',borderTop:`1px solid ${r.palette.secondary.main}`,margin:"0 0 0 20px",flex:"1 0 20px"}})),qe=b("form")(({theme:r})=>({display:"flex",flexDirection:"column",gap:"2rem",width:"70%",[`& .${c.btnContainer}`]:{display:"flex",alignItems:"center",justifyContent:"space-evenly"},[`& .${c.helper}`]:{color:r.palette.text.primary}})),De=r=>{var D,V,_,z,H;const{signup:s}=i.exports.useContext(M),o=X(),{from:n}=(o==null?void 0:o.state)||{pathname:"/dashboard"},y=ge().shape({password:O().required("Le mot de passe est obligatoire").min(6,"Le mot de passe doit contenir au moins 6 caract\xE8res"),confirmPwd:O().required("Le mot de passe est obligatoire").oneOf([ve("password")],"Les mots de passe ne sont pas identiques")}),t=F({mode:"onBlur",resolver:be(y)}),[l,d]=i.exports.useState(!1),[f,x]=i.exports.useState(!1),[h,S]=i.exports.useState(),m=R(),p=()=>d(!0),E=()=>d(!1),ee=async g=>{const re={email:g.email,password:g.password,firstName:g.firstName,lastName:g.lastName};try{await s(re),m(n?n.pathname:"/dashboard")}catch(te){S(te),x(!0)}};return a($,{children:[e(u,{variant:"contained",color:"info",type:"button",onClick:p,children:"Je me cr\xE9er mon compte"}),e(je,{open:l,onClose:E,"aria-labelledby":"Se cr\xE9er un compte","aria-describedby":"Remplir le formulaire pour se cr\xE9er un compte",children:a(Q,{sx:Fe,children:[e(G,{variant:"h4",component:"h2",align:"center",className:c.title,children:"Se cr\xE9er un compte"}),e(J,{...t,children:a(qe,{onSubmit:t.handleSubmit(ee),children:[e(w,{...t.register("firstName",{required:{value:!0,message:"Le pr\xE9nom est obligatoire"},validate:B||"Le pr\xE9nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:t.formState.errors.firstName&&((D=t.formState.errors.firstName)==null?void 0:D.message),FormHelperTextProps:{className:c.helper},label:"Pr\xE9nom",type:"text",color:"info",variant:"filled",required:!0}),e(w,{...t.register("lastName",{required:{value:!0,message:"Le nom est obligatoire"},validate:g=>B(g)||"Le nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:t.formState.errors.lastName&&((V=t.formState.errors.lastName)==null?void 0:V.message),FormHelperTextProps:{className:c.helper},label:"Nom",type:"text",color:"info",variant:"filled",required:!0}),e(w,{...t.register("email",{required:{value:!0,message:"L'email est obligatoire"},validate:j||"Vous devez saisir un email valide"}),defaultValue:"",helperText:t.formState.errors.email&&((_=t.formState.errors.email)==null?void 0:_.message),FormHelperTextProps:{className:c.helper},color:"info",type:"email",label:"Email",variant:"filled",required:!0}),e(A,{name:"password",color:"info",defaultValue:"",error:t.formState.errors.password!==void 0,errorMessage:(z=t.formState.errors.password)==null?void 0:z.message,fullWidth:!0,id:"signup-password",label:"Mot de passe"}),e(A,{name:"confirmPwd",color:"info",defaultValue:"",error:t.formState.errors.confirmPwd!==void 0,errorMessage:(H=t.formState.errors.confirmPwd)==null?void 0:H.message,fullWidth:!0,id:"confirm-signup-password",label:"Confirmez le mot de passe"}),f&&e(L,{onClose:()=>{x(!1),S("")},severity:"error",children:a($,{children:["Une erreur est survenue, veuillez r\xE9essayer.",e("br",{}),"Message: ",h]})}),a("div",{className:c.btnContainer,children:[e(u,{variant:"contained",color:"info",type:"reset",children:"R\xC9INITIALISER"}),e(u,{variant:"contained",color:"info",type:"submit",children:"VALIDER"})]})]})})]})})]})},T="Home",v={root:`${T}-root`,left:`${T}-left`,right:`${T}-right`,logo:`${T}-logo`},Ve=b(N)(({theme:r})=>({display:"flex",flexDirection:"row",width:"100vw",height:"100vh",minHeight:"100vh",[`& .${v.left}`]:{backgroundColor:r.palette.secondary.main,paddingTop:"10%"},[`& .${v.right}`]:{backgroundColor:r.palette.primary.main},[`& .${v.logo}`]:{height:"auto",width:"auto",alignSelf:"center",marginBottom:"1.5rem","&:hover":{cursor:"pointer"}}})),_e=({children:r})=>{const s=R(),o=xe("(max-width: 900px)");return a(Ve,{container:!0,children:[e(N,{item:!0,display:o?"none":"flex",md:6,xs:0,justifyContent:"center",className:v.left,children:e(Q,{component:"img",sx:{height:400,width:400},alt:"Une illustration des t\xE2ches complet\xE9es",src:"/images/todo_illustration.svg"})}),a(N,{item:!0,md:6,xs:12,container:!0,direction:"column",justifyContent:"center",alignItems:"center",className:v.right,children:[e(he,{variant:"square",alt:"TODO",src:"/images/logo_size.jpg",onClick:()=>s("/"),className:v.logo}),r]})]})},I=b(G)(({theme:r})=>({marginTop:"20px",marginBottom:"20px",color:r.palette.text.primary,display:"flex",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center",["&:before"]:{content:'""',borderTop:`1px solid ${r.palette.secondary.main}`,margin:"0 20px 0 0",flex:"1 0 20px"},["&:after"]:{content:'""',borderTop:`1px solid ${r.palette.secondary.main}`,margin:"0 0 0 20px",flex:"1 0 20px"}})),ze=r=>{const{user:s}=i.exports.useContext(M),o=R();return i.exports.useEffect(()=>{s&&o("/dashboard")},[o,s]),a(_e,{children:[e(I,{variant:"h5",align:"center",children:"J\u2019ai d\xE9j\xE0 un compte"}),e(Me,{}),e(I,{variant:"h5",align:"center",children:"Je souhaite cr\xE9er un compte"}),e(N,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:e(De,{})})]})};var We=Object.freeze(Object.defineProperty({__proto__:null,StyledTypo:I,default:ze},Symbol.toStringTag,{value:"Module"}));export{We as H,_e as R,I as S,Ne as t};
