import{D as U,b as X}from"./DashWrapper.206f4038.js";import{a as s,j as t,d as g,F as R}from"./recharts.547c5d9d.js";import{s as P,c as y,o as G,j as O,_ as J,k as Y,l as K,A as V,u as I,b as W}from"./index.6159fe3b.js";import{u as H,T as $,A as N,F as Q,S as Z,D as ee,a as te,b as re,c as oe,d as ae}from"./StyledDialog.240e69e2.js";import{G as x,a as k,i as ie,B as j,k as se,T as F}from"./jsx-runtime_commonjs-proxy.a8f8d0db.js";import{L as B,d as M}from"./Save.cf99a474.js";import{g as ne,S as T,a as le}from"./Delete.7556fabd.js";import{c as ce,a as _,b as de,o as me,P as q}from"./object.d0cba29c.js";import"./editor.b46b26d8.js";const pe=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],ue=r=>{const{absolute:e,children:o,classes:n,flexItem:d,light:m,orientation:a,textAlign:i,variant:l}=r;return K({root:["root",e&&"absolute",l,m&&"light",a==="vertical"&&"vertical",d&&"flexItem",o&&"withChildren",o&&a==="vertical"&&"withChildrenVertical",i==="right"&&a!=="vertical"&&"textAlignRight",i==="left"&&a!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",a==="vertical"&&"wrapperVertical"]},ne,n)},fe=P("div",{name:"MuiDivider",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.root,o.absolute&&e.absolute,e[o.variant],o.light&&e.light,o.orientation==="vertical"&&e.vertical,o.flexItem&&e.flexItem,o.children&&e.withChildren,o.children&&o.orientation==="vertical"&&e.withChildrenVertical,o.textAlign==="right"&&o.orientation!=="vertical"&&e.textAlignRight,o.textAlign==="left"&&o.orientation!=="vertical"&&e.textAlignLeft]}})(({theme:r,ownerState:e})=>y({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(r.vars||r).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:r.vars?`rgba(${r.vars.palette.dividerChannel} / 0.08)`:G(r.palette.divider,.08)},e.variant==="inset"&&{marginLeft:72},e.variant==="middle"&&e.orientation==="horizontal"&&{marginLeft:r.spacing(2),marginRight:r.spacing(2)},e.variant==="middle"&&e.orientation==="vertical"&&{marginTop:r.spacing(1),marginBottom:r.spacing(1)},e.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({theme:r,ownerState:e})=>y({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(r.vars||r).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}}),({theme:r,ownerState:e})=>y({},e.children&&e.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(r.vars||r).palette.divider}`,transform:"translateX(0%)"}}),({ownerState:r})=>y({},r.textAlign==="right"&&r.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},r.textAlign==="left"&&r.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),he=P("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.wrapper,o.orientation==="vertical"&&e.wrapperVertical]}})(({theme:r,ownerState:e})=>y({display:"inline-block",paddingLeft:`calc(${r.spacing(1)} * 1.2)`,paddingRight:`calc(${r.spacing(1)} * 1.2)`},e.orientation==="vertical"&&{paddingTop:`calc(${r.spacing(1)} * 1.2)`,paddingBottom:`calc(${r.spacing(1)} * 1.2)`})),xe=s.exports.forwardRef(function(e,o){const n=O({props:e,name:"MuiDivider"}),{absolute:d=!1,children:m,className:a,component:i=m?"div":"hr",flexItem:l=!1,light:v=!1,orientation:h="horizontal",role:p=i!=="hr"?"separator":void 0,textAlign:u="center",variant:f="fullWidth"}=n,w=J(n,pe),c=y({},n,{absolute:d,component:i,flexItem:l,light:v,orientation:h,role:p,textAlign:u,variant:f}),E=ue(c);return t(fe,y({as:i,className:Y(E.root,a),role:p,ref:o,ownerState:c},w,{children:m?t(he,{className:E.wrapper,ownerState:c,children:m}):null}))});var z=xe;const ge="Account",L={helper:`${ge}-helper`},ve=P("form")(({theme:r})=>({width:"100%",display:"flex",flexDirection:"column",gap:"2rem",marginTop:"2rem",marginBottom:"2rem",[`&. ${L.helper}`]:{color:r.palette.text.primary}})),be=r=>{var S,C,b;const{user:e,updateUser:o}=s.exports.useContext(V),n=I(),d=W(),[m,a]=s.exports.useState(!1),[i,l]=s.exports.useState(!1),[v,h]=s.exports.useState(!1);e||n("/",{state:{from:d}});const{register:p,handleSubmit:u,formState:{errors:f}}=H({mode:"onBlur",defaultValues:{firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName,email:e==null?void 0:e.email}}),w=async D=>{if(a(!0),!e){n("/",{state:{from:d}});return}try{await o(D,e==null?void 0:e._id),h(!0)}catch(A){console.error({error:A}),l(!0)}finally{a(!1)}},c=(D,A)=>{A!=="clickaway"&&l(!1)},E=(D,A)=>{A!=="clickaway"&&h(!1)};return g(R,{children:[g(ve,{onSubmit:u(w),children:[g(x,{item:!0,xs:12,display:"flex",children:[t(x,{item:!0,xs:12,md:6,paddingRight:".5rem",children:t($,{...p("firstName",{required:{value:!0,message:"Le pr\xE9nom est obligatoire"},validate:k||"Le pr\xE9nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:f.firstName&&((S=f.firstName)==null?void 0:S.message),FormHelperTextProps:{className:L.helper},fullWidth:!0,label:"Pr\xE9nom",type:"text",color:"info",variant:"filled",required:!0,defaultValue:e==null?void 0:e.firstName})}),t(x,{item:!0,xs:12,md:6,paddingLeft:".5rem",children:t($,{...p("lastName",{required:{value:!0,message:"Le nom est obligatoire"},validate:D=>k(D)||"Le nom contient des caract\xE8res sp\xE9ciaux non autoris\xE9s"}),helperText:f.lastName&&((C=f.lastName)==null?void 0:C.message),FormHelperTextProps:{className:L.helper},label:"Nom",type:"text",color:"info",variant:"filled",required:!0,fullWidth:!0,defaultValue:e==null?void 0:e.lastName})})]}),t(x,{item:!0,xs:12,children:t($,{...p("email",{required:{value:!0,message:"L'email est obligatoire"},validate:ie||"Vous devez saisir un email valide"}),defaultValue:e==null?void 0:e.email,helperText:f.email&&((b=f.email)==null?void 0:b.message),FormHelperTextProps:{className:L.helper},color:"info",type:"email",label:"Email",variant:"filled",required:!0,fullWidth:!0})}),t(x,{item:!0,xs:12,display:"flex",justifyContent:"end",children:t(B,{loading:m,type:"submit",loadingPosition:"start",startIcon:t(M,{}),variant:"contained",color:"info",children:"Enregistrer les modifications"})})]}),t(T,{open:v,autoHideDuration:6e3,onClose:E,children:t(N,{onClose:E,severity:"success",sx:{width:"100%"},children:"Vos informations ont bient \xE9t\xE9 mises \xE0 jour."})}),t(T,{open:i,autoHideDuration:6e3,onClose:c,children:t(N,{onClose:c,severity:"error",sx:{width:"100%"},children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."})})]})},we="Password",Ee={helper:`${we}-helper`},ye=P("form")(({theme:r})=>({width:"100%",display:"flex",flexDirection:"column",gap:"2rem",marginTop:"2rem",marginBottom:"2rem",[`&. ${Ee.helper}`]:{color:r.palette.text.primary}})),Ce=r=>{var E,S;const{user:e,updatePassword:o}=s.exports.useContext(V),n=I(),d=W(),[m,a]=s.exports.useState(!1),[i,l]=s.exports.useState(!1),[v,h]=s.exports.useState(!1),p=ce().shape({password:_().required("Le mot de passe est obligatoire").min(6,"Le mot de passe doit contenir au moins 6 caract\xE8res"),confirmPassword:_().required("Le mot de passe est obligatoire").oneOf([de("password")],"Les mots de passe ne sont pas identiques")}),u=H({mode:"onBlur",resolver:me(p)}),f=async C=>{if(a(!0),!e){n("/",{state:{from:d}});return}try{await o({password:C.password},e._id)?l(!0):h(!0)}catch(b){console.error({error:b}),h(!0)}finally{a(!1)}},w=(C,b)=>{b!=="clickaway"&&h(!1)},c=(C,b)=>{b!=="clickaway"&&l(!1)};return g(R,{children:[t(Q,{...u,children:g(ye,{onSubmit:u.handleSubmit(f),children:[g(x,{item:!0,xs:12,display:"flex",children:[t(x,{item:!0,xs:12,md:6,paddingRight:".5rem",children:t(q,{name:"password",color:"info",defaultValue:"",error:u.formState.errors.password!==void 0,errorMessage:(E=u.formState.errors.password)==null?void 0:E.message,fullWidth:!0,id:"new-password",label:"Nouveau mot de passe"})}),t(x,{item:!0,xs:12,md:6,paddingLeft:".5rem",children:t(q,{name:"confirmPassword",color:"info",defaultValue:"",error:u.formState.errors.confirmPassword!==void 0,errorMessage:(S=u.formState.errors.confirmPassword)==null?void 0:S.message,fullWidth:!0,id:"confirm-new-password",label:"Confirmez le nouveau mot de passe"})})]}),t(x,{item:!0,xs:12,display:"flex",justifyContent:"end",children:t(B,{loading:m,type:"submit",loadingPosition:"start",startIcon:t(M,{}),variant:"contained",color:"info",children:"Enregistrer le nouveau mot de passe"})})]})}),t(T,{open:i,autoHideDuration:6e3,onClose:c,children:t(N,{onClose:c,severity:"success",sx:{width:"100%"},children:"Votre mot de passe a bien \xE9t\xE9 mis \xE0 jour."})}),t(T,{open:v,autoHideDuration:6e3,onClose:w,children:t(N,{onClose:w,severity:"error",sx:{width:"100%"},children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."})})]})},Se=r=>{const{user:e,deleteUser:o,logout:n}=s.exports.useContext(V),d=I(),m=W(),[a,i]=s.exports.useState(!1),[l,v]=s.exports.useState(!1),[h,p]=s.exports.useState(!1);return g(R,{children:[t("div",{style:{display:"flex",justifyContent:"end",marginBottom:"1rem",marginTop:"1rem"},children:t(j,{onClick:()=>i(!0),variant:"contained",color:"info",startIcon:t(le,{}),children:"Je supprime mon compte"})}),g(Z,{open:a,setOpen:i,labelledby:"delete account",children:[t(ee,{id:"delete-account",children:"\xCAtes vous s\xFBr de vouloir supprimer votre compte"}),t(te,{children:t(re,{children:"Votre compte sera d\xE9finitivement supprim\xE9 et ne pourra pas \xEAtre r\xE9cupr\xE9. Toutes vos todos seront \xE9galement supprim\xE9s."})}),g(oe,{children:[h&&t(ae,{severity:"error",onClose:()=>p(!1),children:"Un probl\xE8me est survenu, veuillez r\xE9essayer."}),t(j,{autoFocus:!0,disabled:l,color:"info",onClick:w=>{i(!1)},children:"Annuler"}),t(B,{loading:l,onClick:async w=>{if(v(!0),!e){d("/",{state:{from:m}});return}try{if((await o(e._id)).nDeleted>0){n(),d("/");return}else throw new Error("Le compte n'a pas pu \xEAtre supprim\xE9")}catch(c){console.error({error:c}),p(!0)}finally{v(!1)}},color:"info",autoFocus:!0,children:"Supprimer"})]})]})]})},Ve=r=>{const e=se();return t(U,{Icon:X,title:"PARAM\xC8TRES",children:g(x,{item:!0,xs:12,display:"flex",flexDirection:"column",children:[t(F,{component:"h1",variant:"h3",sx:{color:e.palette.text.primary},children:"Mes informations"}),t(be,{}),t(z,{}),t(F,{component:"h1",variant:"h3",sx:{color:e.palette.text.primary},mt:"2rem",children:"Changer mon mot de passe"}),t(Ce,{}),t(z,{}),t(F,{component:"h1",variant:"h3",sx:{color:e.palette.text.primary},mt:"2rem",children:"Supprimer mon compte"}),t(Se,{})]})})};export{Ve as default};
