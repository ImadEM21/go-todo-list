import{s as L,X as I,r as o,j as p,b as e,a as $}from"./index.b861c819.js";import{R as j,S as F,t as A}from"./Home.597886d2.js";import{u as N,F as R,A as f}from"./StyledDialog.1e3ba017.js";import{c as V,a as h,b as q,P as x,o as z}from"./object.d108c3b1.js";import{L as T,d as k}from"./Save.2a9ff049.js";import{T as B}from"./jsx-runtime_commonjs-proxy.5d8c4483.js";import"./Box.9a47da23.js";import"./upperFirst.8be579a9.js";const v="NewPassword",n={btnContainer:`${v}-btnContainer`,helper:`${v}-helper`},D=L("form")(({theme:i})=>({display:"flex",flexDirection:"column",gap:"2rem",width:"70%",[`& .${n.btnContainer}`]:{display:"flex",flexDirection:"column",gap:".5rem",alignItems:"center",justifyContent:"center"},[`& .${n.helper}`]:{color:i.palette.text.primary}})),J=i=>{var c,u;const{userId:l,token:d}=I(),[w,t]=o.exports.useState(!1),[b,a]=o.exports.useState(!1),[g,m]=o.exports.useState(!1),[y,S]=o.exports.useState(!1),P=V().shape({password:h().required("Le mot de passe est obligatoire").min(6,"Le mot de passe doit contenir au moins 6 caract\xE8res"),confirmPassword:h().required("Le mot de passe est obligatoire").oneOf([q("password")],"Les mots de passe ne sont pas identiques")}),s=N({mode:"onBlur",resolver:z(P)}),E=C=>{if(t(!0),!l||!d){S(!0),t(!1);return}A.resetPassword(l,d,{password:C.password}).then(r=>{m(!0)}).catch(r=>{if($.isAxiosError(r)){console.error(r.response),a(!0);return}console.error({error:r}),a(!0)}).finally(()=>{t(!1)})};return p(j,{children:[e(F,{variant:"h5",align:"center",children:"R\xE9initialiser mon mot de passe"}),y?e(B,{variant:"h3",children:"Le lien n'est pas valide, veuillez renvoyer le formulaire de r\xE9initialisation de mot de passe"}):e(R,{...s,children:p(D,{onSubmit:s.handleSubmit(E),children:[e(x,{name:"password",color:"info",defaultValue:"",error:s.formState.errors.password!==void 0,errorMessage:(c=s.formState.errors.password)==null?void 0:c.message,fullWidth:!0,id:"reset-password",label:"Nouveau mot de passe"}),e(x,{name:"confirmPassword",color:"info",defaultValue:"",error:s.formState.errors.confirmPassword!==void 0,errorMessage:(u=s.formState.errors.confirmPassword)==null?void 0:u.message,fullWidth:!0,id:"confirm-reset-password",label:"Confirmez le nouveau mot de passe"}),b&&e(f,{onClose:()=>{a(!1)},severity:"error",children:"Une erreur est survenue, veuillez r\xE9essayer."}),g&&e(f,{onClose:()=>{m(!1)},severity:"success",children:"Votre mot de passe a bien \xE9t\xE9 mis \xE0 jour."}),e("div",{className:n.btnContainer,children:e(T,{loading:w,loadingPosition:"start",startIcon:e(k,{}),variant:"contained",color:"info",type:"submit",children:"Valider le nouveau mot de passe"})})]})})]})};export{J as default};
